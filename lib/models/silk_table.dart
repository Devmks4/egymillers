class SilkTable {

  static List <Map <String , String>> ggTable  = [{"id": "12", "micron": "1800", "diameter": "500", "holescm": "4.4", "percentage": "61"}, {"id": "14", "micron": "1600", "diameter": "450", "holescm": "5", "percentage": "60"}, {"id": "15", "micron": "1400", "diameter": "400", "holescm": "5.4", "percentage": "59"}, {"id": "16", "micron": "1320", "diameter": "400", "holescm": "5.8", "percentage": "59"}, {"id": "17", "micron": "1250", "diameter": "350", "holescm": "6.1", "percentage": "58"}, {"id": "18", "micron": "1180", "diameter": "350", "holescm": "6.5", "percentage": "59"}, {"id": "19", "micron": "1120", "diameter": "350", "holescm": "6.7", "percentage": "58"}, {"id": "20", "micron": "1000", "diameter": "320", "holescm": "7.5", "percentage": "57"}, {"id": "22", "micron": "950", "diameter": "300", "holescm": "8", "percentage": "57"}, {"id": "23", "micron": "900", "diameter": "300", "holescm": "8.3", "percentage": "56"}, {"id": "24", "micron": "850", "diameter": "300", "holescm": "8.7", "percentage": "53"}, {"id": "26", "micron": "800", "diameter": "280", "holescm": "9.4", "percentage": "53"}, {"id": "27", "micron": "750", "diameter": "280", "holescm": "9.7", "percentage": "52"}, {"id": "28", "micron": "710", "diameter": "260", "holescm": "10.5", "percentage": "53"}, {"id": "30", "micron": "670", "diameter": "260", "holescm": "10.8", "percentage": "53"}, {"id": "31", "micron": "630", "diameter": "240", "holescm": "11.5", "percentage": "53"}, {"id": "32", "micron": "600", "diameter": "240", "holescm": "11.9", "percentage": "51"}, {"id": "34", "micron": "560", "diameter": "240", "holescm": "12.3", "percentage": "49"}, {"id": "36", "micron": "530", "diameter": "220", "holescm": "13.3", "percentage": "50"}, {"id": "38", "micron": "500", "diameter": "220", "holescm": "13.7", "percentage": "47"}, {"id": "40", "micron": "475", "diameter": "200", "holescm": "15", "percentage": "48"}, {"id": "42", "micron": "450", "diameter": "200", "holescm": "15.4", "percentage": "48"}, {"id": "44", "micron": "425", "diameter": "200", "holescm": "16", "percentage": "46"}, {"id": "45", "micron": "400", "diameter": "180", "holescm": "16.8", "percentage": "47"}, {"id": "47", "micron": "375", "diameter": "180", "holescm": "17.5", "percentage": "47"}, {"id": "50", "micron": "355", "diameter": "160", "holescm": "19.4", "percentage": "48"}, {"id": "52", "micron": "335", "diameter": "160", "holescm": "20.2", "percentage": "46"}, {"id": "54", "micron": "315", "diameter": "160", "holescm": "21", "percentage": "44"}, {"id": "58", "micron": "300", "diameter": "140", "holescm": "21.7", "percentage": "45"}, {"id": "60", "micron": "280", "diameter": "140", "holescm": "23.8", "percentage": "45"}, {"id": "62", "micron": "275", "diameter": "140", "holescm": "24.1", "percentage": "44"}, {"id": "64", "micron": "265", "diameter": "140", "holescm": "25", "percentage": "43"}, {"id": "66", "micron": "250", "diameter": "120", "holescm": "26.5", "percentage": "46"}, {"id": "68", "micron": "243", "diameter": "120", "holescm": "27.5", "percentage": "44"}, {"id": "70", "micron": "236", "diameter": "120", "holescm": "28", "percentage": "44"}, {"id": "72", "micron": "224", "diameter": "120", "holescm": "29", "percentage": "42"}, {"id": "74", "micron": "212", "diameter": "120", "holescm": "30", "percentage": "40"}];
  static List <Map <String , String>> xxxTable = [{"id": "3", "micron": "300", "diameter": "140", "holescm": "21.7", "percentage": "45"}, {"id": "4", "micron": "280", "diameter": "140", "holescm": "23.8", "percentage": "45"}, {"id": "5", "micron": "250", "diameter": "120", "holescm": "26.5", "percentage": "46"}, {"id": "6", "micron": "212", "diameter": "120", "holescm": "30", "percentage": "40"}, {"id": "7", "micron": "200", "diameter": "120", "holescm": "31.2", "percentage": "39"}, {"id": "8", "micron": "180", "diameter": "100", "holescm": "36", "percentage": "39"}, {"id": "8.5", "micron": "160", "diameter": "100", "holescm": "37.5", "percentage": "37"}, {"id": "9", "micron": "150", "diameter": "90", "holescm": "41", "percentage": "38"}, {"id": "9.5", "micron": "140", "diameter": "90", "holescm": "44", "percentage": "37"}, {"id": "10", "micron": "132", "diameter": "80", "holescm": "45", "percentage": "40"}, {"id": "10.5", "micron": "125", "diameter": "80", "holescm": "48.8", "percentage": "37"}, {"id": "11", "micron": "118", "diameter": "80", "holescm": "49", "percentage": "34"}, {"id": "12", "micron": "112", "diameter": "70", "holescm": "55", "percentage": "38"}, {"id": "13", "micron": "100", "diameter": "70", "holescm": "57", "percentage": "32"}, {"id": "14", "micron": "95", "diameter": "70", "holescm": "60.6", "percentage": "33"}, {"id": "14.5", "micron": "90", "diameter": "60", "holescm": "67", "percentage": "36"}, {"id": "17", "micron": "85", "diameter": "60", "holescm": "68", "percentage": "35"}];
  static List <Map <String , String>> metalTable = [{"id": "2000", "micron": "2000", "diameter": "320", "holescm": "4.3", "percentage": "74"}, {"id": "1800", "micron": "1800", "diameter": "320", "holescm": "4.7", "percentage": "72"}, {"id": "1600", "micron": "1600", "diameter": "220", "holescm": "5.5", "percentage": "77"}, {"id": "1400", "micron": "1400", "diameter": "220", "holescm": "6.2", "percentage": "74.5"}, {"id": "1250", "micron": "1250", "diameter": "220", "holescm": "6.8", "percentage": "72"}, {"id": "1180", "micron": "1180", "diameter": "220", "holescm": "7.1", "percentage": "71"}, {"id": "1120", "micron": "1120", "diameter": "220", "holescm": "7.5", "percentage": "69.4"}, {"id": "1060", "micron": "1060", "diameter": "220", "holescm": "7.8", "percentage": "68.6"}, {"id": "1000", "micron": "1000", "diameter": "220", "holescm": "8.3", "percentage": "67"}, {"id": "950", "micron": "950", "diameter": "200", "holescm": "8.7", "percentage": "68.2"}, {"id": "900", "micron": "900", "diameter": "200", "holescm": "9.1", "percentage": "67"}, {"id": "850", "micron": "850", "diameter": "200", "holescm": "9.4", "percentage": "65.5"}, {"id": "800", "micron": "800", "diameter": "200", "holescm": "9.8", "percentage": "64"}, {"id": "750", "micron": "750", "diameter": "180", "holescm": "10.6", "percentage": "65"}, {"id": "710", "micron": "710", "diameter": "180", "holescm": "11.4", "percentage": "64"}, {"id": "670", "micron": "670", "diameter": "160", "holescm": "12.2", "percentage": "65.2"}, {"id": "630", "micron": "630", "diameter": "160", "holescm": "12.6", "percentage": "64"}, {"id": "600", "micron": "600", "diameter": "160", "holescm": "13", "percentage": "62.3"}, {"id": "560", "micron": "560", "diameter": "160", "holescm": "13.8", "percentage": "60"}, {"id": "530", "micron": "530", "diameter": "160", "holescm": "14.6", "percentage": "59"}, {"id": "500", "micron": "500", "diameter": "160", "holescm": "15", "percentage": "57.6"}, {"id": "475", "micron": "475", "diameter": "160", "holescm": "15.7", "percentage": "56"}, {"id": "450", "micron": "450", "diameter": "140", "holescm": "16.9", "percentage": "57.6"}, {"id": "425", "micron": "425", "diameter": "140", "holescm": "17.7", "percentage": "56.6"}, {"id": "400", "micron": "400", "diameter": "140", "holescm": "18.5", "percentage": "54"}, {"id": "375", "micron": "375", "diameter": "140", "holescm": "19.3", "percentage": "53"}, {"id": "355", "micron": "355", "diameter": "140", "holescm": "20.1", "percentage": "51"}, {"id": "335", "micron": "335", "diameter": "140", "holescm": "20.9", "percentage": "49.7"}, {"id": "315", "micron": "315", "diameter": "112", "holescm": "23.2", "percentage": "54"}, {"id": "300", "micron": "300", "diameter": "112", "holescm": "24.4", "percentage": "53"}, {"id": "280", "micron": "280", "diameter": "112", "holescm": "25.6", "percentage": "51"}, {"id": "265", "micron": "265", "diameter": "100", "holescm": "27.6", "percentage": "52.8"}, {"id": "250", "micron": "250", "diameter": "100", "holescm": "28.7", "percentage": "53"}, {"id": "245", "micron": "245", "diameter": "65", "holescm": "32.3", "percentage": "62"}, {"id": "236", "micron": "236", "diameter": "100", "holescm": "29.9", "percentage": "51"}, {"id": "224", "micron": "224", "diameter": "100", "holescm": "30.7", "percentage": "49"}, {"id": "212", "micron": "212", "diameter": "90", "holescm": "33.1", "percentage": "49"}, {"id": "180", "micron": "180", "diameter": "90", "holescm": "37", "percentage": "45"}, {"id": "160", "micron": "160", "diameter": "75", "holescm": "41", "percentage": "46"}, {"id": "140", "micron": "140", "diameter": "67", "holescm": "47.2", "percentage": "46"}, {"id": "132", "micron": "132", "diameter": "65", "holescm": "53.1", "percentage": "49"}, {"id": "125", "micron": "125", "diameter": "56", "holescm": "55.1", "percentage": "48"}, {"id": "106", "micron": "106", "diameter": "50", "holescm": "64.2", "percentage": "46"}];

  static Map<String, String>? searchRow(String searchValue , List<Map<String, String>> searchList) {
  for (final row in searchList) {
    // Check all columns in the row
    for (final value in row.values) {
      if (value.toString() == searchValue.toString()) {
        return row; // return the full matching row
      }
    }
  }
  return null; // if not found
}

  static Map<String, String> searchExact(List<Map<String, String>> data,String key,String value){

           int index = data.indexWhere((row) => row[key] == value);
           if(index >= 0){
             return data[index];
           }
           else{
               return {"id": "0", "micron": "0", "diameter": "0", "holescm": "0", "percentage": "0"};
           }
        }

  static bool foundExact = false , foundNear = false ;

  static dynamic searchSmart(
      List<Map<String, String>> data, String key, String value) {
    // 1Ô∏è‚É£ Try exact match first
    int exactIndex = data.indexWhere((row) => row[key] == value);
    if (exactIndex >= 0) {
      foundExact = true ;
      foundNear = false ;
      return data[exactIndex];
      // Return a single map if exact match found
    }

    // 2Ô∏è‚É£ If not found, call fallback numeric search
    return _searchNearestValues(data, key, value);
  }

  /// üîç Helper method: find two smaller and two greater numeric values
  static List<Map<String, String>> _searchNearestValues(
      List<Map<String, String>> data, String key, String value) {

    double target = double.tryParse(value) ?? 0;

    // Parse all valid numeric values
    List<double> numericValues = data
        .map((row) => double.tryParse(row[key] ?? ''))
        .where((v) => v != null)
        .cast<double>()
        .toList();

    if (numericValues.isEmpty) {
      foundExact = false ;
      foundNear = false ;
      return [_defaultRow];
    }

    // Sort ascending
    numericValues.sort();

    // Get smaller and greater values
    List<double> smaller =
    numericValues.where((v) => v < target).toList().reversed.take(2).toList();
    List<double> greater =
    numericValues.where((v) => v > target).take(2).toList();

    // Combine them in logical order (smaller first, then greater)
    List<double> nearby = [...smaller.reversed, ...greater];

    // Get corresponding maps for each found numeric value
    List<Map<String, String>> results = nearby.map((num) {
      return data.firstWhere(
            (row) => double.tryParse(row[key] ?? '') == num,
        orElse: () => _defaultRow,
      );
    }).toList();

    // If still nothing found
    if (results.isEmpty) {
      foundExact = false ;
      foundNear = false ;
      return [_defaultRow];
    }
    foundExact = false ;
    foundNear = true ;
    return results;
  }

  static const Map<String, String> _defaultRow = {
    "id": "0",
    "micron": "0",
    "diameter": "0",
    "holescm": "0",
    "percentage": "0"
  };

  static dynamic searchSmartUpdated(
      List<Map<String, String>> data, String key, String value) {
    // 1Ô∏è‚É£ Try exact match first
    int exactIndex = data.indexWhere((row) => row[key] == value);
    if (exactIndex >= 0) {
      return data[exactIndex]; // Return single map if exact match found
    }

    // 2Ô∏è‚É£ If not found, call fallback numeric search
    return _searchNearestValuesUpdated(data, key, value);
  }

  /// üîç Helper method: find up to two smaller and two greater numeric values
  static List<Map<String, String>> _searchNearestValuesUpdated(
      List<Map<String, String>> data, String key, String value) {

    double target = double.tryParse(value) ?? 0;

    // Parse numeric values safely
    List<double> numericValues = data
        .map((row) => double.tryParse(row[key] ?? ''))
        .where((v) => v != null)
        .cast<double>()
        .toList();

    if (numericValues.isEmpty) {
      return [_defaultRowUpdated];
    }

    // Sort ascending
    numericValues.sort();

    // Find smaller and greater values
    List<double> smaller =
    numericValues.where((v) => v < target).toList().reversed.take(2).toList();
    List<double> greater =
    numericValues.where((v) => v > target).take(2).toList();

    // ‚úÖ Always include whichever side exists
    List<double> nearby = [...smaller.reversed, ...greater];

    // Get matching maps for each nearby numeric value
    List<Map<String, String>> results = nearby.map((num) {
      return data.firstWhere(
            (row) => double.tryParse(row[key] ?? '') == num,
        orElse: () => _defaultRowUpdated,
      );
    }).toList();

    // If nothing found at all, return default
    if (results.isEmpty) {
      return [_defaultRowUpdated];
    }

    return results;
  }

  static const Map<String, String> _defaultRowUpdated = {
    "id": "0",
    "micron": "0",
    "diameter": "0",
    "holescm": "0",
    "percentage": "0"
  };

// end of class
}